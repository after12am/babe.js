/*
 * toyscript.js v0.1.2
 * https://github.com/after12am/toyscript
 *
 * Copyright 2013-2016 Satoshi Okami
 * Released under the MIT license
 */
module.exports=function(){function X(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++){var k=a[b];if(k.type&&k.type.match("text/toyscript")&&((code=k.innerHTML)&&z.interpret(code),k.src)){var c=new XMLHttpRequest;c.open("GET",k.src,!0);c.onreadystatechange=function(){4===c.readyState&&200===c.status&&z.interpret(c.responseText)};c.send()}}}function P(){"complete"===document.readyState?X():setTimeout(P)}var z={};this.window&&setTimeout(P);var K=function(){Array.call(this,arguments);
this.current=null;this.push([])};K.prototype=Object.create(Array.prototype);K.prototype.push=function(){Array.prototype.push.call(this,arguments);this.current=this[this.length-1][0]};K.prototype.pop=function(){if(1>=this.length)throw Error("no current context");Array.prototype.pop.call(this);this.current=this[this.length-1][0]};K.prototype.find=function(a){for(var b=!1,k=this.length-1;0<=k;k--){for(var c=this[k].length-1;0<=c;c--)if(this[k][c][a]){b=this[k][c][a];break}if(b)break}return b};var N=
{};(function(a,b){a(N={},b)})(function(a,b){function c(a){var b=a.length,d=[],n;for(n=0;n<b;n+=1)d[n]=a.charAt(n);return d}function l(a,b){var d="";for(b|=0;0<b;b>>>=1,a+=a)b&1&&(d+=a);return d}function m(a,b,d,n){function e(a){var Q,d;if(R(a))for(Q=0,d=a.length;Q<d;++Q)e(a[Q]);else a instanceof m?f.push(a):"string"===typeof a&&a&&f.push(a)}var f=[];e(n);this.children=f}function r(a){a=a.charAt(a.length-1);return"\r"===a||"\n"===a}function w(a){var b={},d,n;for(d in a)a.hasOwnProperty(d)&&(n=a[d],
b[d]="object"===typeof n&&null!==n?w(n):n);return b}function x(a,b){function d(a){return"object"===typeof a&&a instanceof Object&&!(a instanceof RegExp)}var n,e;for(n in b)b.hasOwnProperty(n)&&(e=b[n],d(e)?d(a[n])?x(a[n],e):a[n]=x({},e):a[n]=e);return a}function z(a){var b,d,n,e,f;if(a!==a)throw Error("Numeric literal whose value is NaN");if(0>a||0===a&&0>1/a)throw Error("Numeric literal whose value is negative");if(a===1/0)return F?"null":Y?"1e400":"1e+400";b=""+a;if(!Y||3>b.length)return b;d=b.indexOf(".");
F||"0"!==b.charAt(0)||1!==d||(d=0,b=b.slice(1));n=b;b=b.replace("e+","e");e=0;0<(f=n.indexOf("e"))&&(e=+n.slice(f+1),n=n.slice(0,f));0<=d&&(e-=n.length-d-1,n=+(n.slice(0,d)+n.slice(d+1))+"");for(f=0;"0"===n.charAt(n.length+f-1);)--f;0!==f&&(e-=f,n=n.slice(0,f));0!==e&&(n+="e"+e);(n.length<b.length||fa&&1E12<a&&Math.floor(a)===a&&(n="0x"+a.toString(16)).length<b.length)&&+n===a&&(b=n);return b}function K(a){var b,d,n,e,f;e=a;"undefined"===typeof e[0]&&(e=c(e));f="double"===S?'"':"'";b=0;for(d=e.length;b<
d;b+=1)if(n=e[b],"'"===n){f='"';break}else if('"'===n){f="'";break}else"\\"===n&&(b+=1);return f+a+f}function N(a){var b="",d,f,e,g=0,h=0;"undefined"===typeof a[0]&&(a=c(a));d=0;for(f=a.length;d<f;d+=1){e=a[d];if("'"===e)g+=1;else if('"'===e)h+=1;else if("/"===e&&F)b+="\\";else if(0<="\\\n\r\u2028\u2029".indexOf(e)){var H="\\";switch(e){case "\\":H+="\\";break;case "\n":H+="n";break;case "\r":H+="r";break;case "\u2028":H+="u2028";break;case "\u2029":H+="u2029";break;default:throw Error("Incorrectly classified character");
}b+=H;continue}else if(F&&" ">e||!(F||ga||" "<=e&&"~">=e)){var H=a[d+1],l=e.charCodeAt(0),p=l.toString(16),t="\\";switch(e){case "\b":t+="b";break;case "\f":t+="f";break;case "\t":t+="t";break;default:t=F||255<l?t+("u"+"0000".slice(p.length)+p):"\x00"===e&&0>"0123456789".indexOf(H)?t+"0":"\v"===e?t+"v":t+("x"+"00".slice(p.length)+p)}b+=t;continue}b+=e}g=!("double"===S||"auto"===S&&h<g);a=b;b=g?"'":'"';"undefined"===typeof a[0]&&(a=c(a));d=0;for(f=a.length;d<f;d+=1){e=a[d];if("'"===e&&g||'"'===e&&
!g)b+="\\";b+=e}return b+(g?"'":'"')}function Z(a){return 0<="\t\v\f \u00a0".indexOf(a)||5760<=a.charCodeAt(0)&&0<="\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\ufeff".indexOf(a)}function aa(a){return 0<="\n\r\u2028\u2029".indexOf(a)}function T(a){return"$"===a||"_"===a||"\\"===a||"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"0"<=a&&"9">=a||128<=a.charCodeAt(0)&&ha.NonAsciiIdentifierPart.test(a)}function y(a,b){if(null==b){if(a instanceof U)return a;b={}}return null==
b.loc?new U(null,null,M,a):new U(b.loc.start.line,b.loc.start.column,!0===M?b.loc.source||null:M,a)}function B(a,b){var d=y(a).toString(),f=y(b).toString(),d=d.charAt(d.length-1),f=f.charAt(0);return("+"===d||"-"===d)&&d===f||T(d)&&T(f)?[a," ",b]:Z(d)||aa(d)||Z(f)||aa(f)?[a,b]:[a,u,b]}function D(a){var b;b=v;v+=I;a=a.call(this,v);v=b;return a}function V(a,b){if("Line"===a.type)return r(a.value)?"//"+a.value:"//"+a.value+"\n";if(L.format.indent.adjustMultilineComment&&/[\n\r]/.test(a.value)){var d=
b,f,e,g,c,k,h;f=("/*"+a.value+"*/").split(/\r\n|[\r\n]/);h=Number.MAX_VALUE;e=1;for(g=f.length;e<g;e+=1){c=f[e];for(k=0;k<c.length&&Z(c[k]);)k+=1;h>k&&(h=k)}"undefined"!==typeof d?(c=v,"*"===f[1][h]&&(d+=" "),v=d):(h&1&&--h,c=v);e=1;for(g=f.length;e<g;e+=1)f[e]=y([v,f[e].slice(h)]).join("");v=c;return f.join("\n")}return"/*"+a.value+"*/"}function P(a,b){var d,f,e,c,k;if(a.leadingComments&&0<a.leadingComments.length){c=b;e=a.leadingComments[0];b=[];O&&a.type===g.Program&&0===a.body.length&&b.push("\n");
b.push(V(e));r(y(b).toString())||b.push("\n");d=1;for(f=a.leadingComments.length;d<f;d+=1)e=a.leadingComments[d],e=[V(e)],r(y(e).toString())||e.push("\n"),b.push([v,e]);b.push([v,c])}if(a.trailingComments){c=!r(y(b).toString());d=y([v,b,I]).toString();for(f=d.length-1;0<=f&&!aa(d.charAt(f));--f);k=l(" ",d.length-1-f);d=0;for(f=a.trailingComments.length;d<f;d+=1)e=a.trailingComments[d],c?(0===d?b.push(I):b.push(k),b.push(V(e,k))):b.push([v,V(e)]),d===f-1||r(y(b).toString())||b.push("\n")}return b}
function G(a,b,d){return b<d?["(",a,")"]:a}function E(a,b,d){var f,e;e=!L.comment||!a.leadingComments;if(a.type===g.BlockStatement&&e)return[u,C(a,{functionBody:d})];if(a.type===g.EmptyStatement&&e)return"";D(function(){f=[A,[v,C(a,{semicolonOptional:b,functionBody:d})]]});return f}function W(a,b){var d=r(y(b).toString());return a.type!==g.BlockStatement||L.comment&&a.leadingComments||d?d?[b,v]:[b,A,v]:[b,u]}function ba(a){var b,d,f;b=["("];d=0;for(f=a.params.length;d<f;d+=1)b.push(a.params[d].name),
d+1<f&&b.push(","+u);b.push(")",E(a.body,!1,!0));return b}function q(a,b){var d,f,e,c,k,l,m,p;f=b.precedence;p=b.allowIn;e=b.allowCall;switch(a.type){case g.SequenceExpression:d=[];p|=h.Sequence<f;c=0;for(k=a.expressions.length;c<k;c+=1)d.push(q(a.expressions[c],{precedence:h.Assignment,allowIn:p,allowCall:!0})),c+1<k&&d.push(","+u);d=G(d,h.Sequence,f);break;case g.AssignmentExpression:p|=h.Assignment<f;d=G([q(a.left,{precedence:h.Call,allowIn:p,allowCall:!0}),u+a.operator+u,q(a.right,{precedence:h.Assignment,
allowIn:p,allowCall:!0})],h.Assignment,f);break;case g.ConditionalExpression:p|=h.Conditional<f;d=G([q(a.test,{precedence:h.LogicalOR,allowIn:p,allowCall:!0}),u+"?"+u,q(a.consequent,{precedence:h.Assignment,allowIn:p,allowCall:!0}),u+":"+u,q(a.alternate,{precedence:h.Assignment,allowIn:p,allowCall:!0})],h.Conditional,f);break;case g.LogicalExpression:case g.BinaryExpression:e=ia[a.operator];p|=e<f;d=B(q(a.left,{precedence:e,allowIn:p,allowCall:!0}),a.operator);l=q(a.right,{precedence:e+1,allowIn:p,
allowCall:!0});"/"===a.operator&&"/"===l.toString().charAt(0)?d.push(" ",l):d=B(d,l);d="in"!==a.operator||p?G(d,e,f):["(",d,")"];break;case g.CallExpression:d=[q(a.callee,{precedence:h.Call,allowIn:!0,allowCall:!0,allowUnparenthesizedNew:!1})];d.push("(");c=0;for(k=a.arguments.length;c<k;c+=1)d.push(q(a.arguments[c],{precedence:h.Assignment,allowIn:!0,allowCall:!0})),c+1<k&&d.push(","+u);d.push(")");d=e?G(d,h.Call,f):["(",d,")"];break;case g.NewExpression:k=a.arguments.length;l=void 0===b.allowUnparenthesizedNew||
b.allowUnparenthesizedNew;d=B("new",q(a.callee,{precedence:h.New,allowIn:!0,allowCall:!1,allowUnparenthesizedNew:l&&!ca&&0===k}));if(!l||ca||0<k){d.push("(");for(c=0;c<k;c+=1)d.push(q(a.arguments[c],{precedence:h.Assignment,allowIn:!0,allowCall:!0})),c+1<k&&d.push(","+u);d.push(")")}d=G(d,h.New,f);break;case g.MemberExpression:d=[q(a.object,{precedence:h.Call,allowIn:!0,allowCall:e,allowUnparenthesizedNew:!1})];a.computed?d.push("[",q(a.property,{precedence:h.Sequence,allowIn:!0,allowCall:e}),"]"):
(a.object.type===g.Literal&&"number"===typeof a.object.value&&0>d.indexOf(".")&&(/[eExX]/.test(d)||2<=d.length&&"0"===d[0]||d.push(".")),d.push("."+a.property.name));d=G(d,h.Member,f);break;case g.UnaryExpression:l=q(a.argument,{precedence:h.Unary,allowIn:!0,allowCall:!0});""===u?d=B(a.operator,l):(d=[a.operator],2<a.operator.length?d=B(d,l):(p=y(d).toString(),p=p.charAt(p.length-1),e=l.toString().charAt(0),("+"===p||"-"===p)&&p===e||T(p)&&T(e)?d.push(" ",l):d.push(l)));d=G(d,h.Unary,f);break;case g.UpdateExpression:d=
a.prefix?G([a.operator,q(a.argument,{precedence:h.Unary,allowIn:!0,allowCall:!0})],h.Unary,f):G([q(a.argument,{precedence:h.Postfix,allowIn:!0,allowCall:!0}),a.operator],h.Postfix,f);break;case g.FunctionExpression:d="function";d=a.id?d+(" "+a.id.name):d+u;d=[d,ba(a)];break;case g.ArrayExpression:if(!a.elements.length){d="[]";break}m=1<a.elements.length;d=["[",m?A:""];D(function(b){c=0;for(k=a.elements.length;c<k;c+=1)a.elements[c]?d.push(m?b:"",q(a.elements[c],{precedence:h.Assignment,allowIn:!0,
allowCall:!0})):(m&&d.push(b),c+1===k&&d.push(",")),c+1<k&&d.push(","+(m?A:u))});m&&!r(y(d).toString())&&d.push(A);d.push(m?v:"","]");break;case g.Property:d="get"===a.kind||"set"===a.kind?[a.kind+" ",q(a.key,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),ba(a.value)]:[q(a.key,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),":"+u,q(a.value,{precedence:h.Assignment,allowIn:!0,allowCall:!0})];break;case g.ObjectExpression:if(!a.properties.length){d="{}";break}m=1<a.properties.length;d=["{",m?A:""];
D(function(b){c=0;for(k=a.properties.length;c<k;c+=1)d.push(m?b:"",q(a.properties[c],{precedence:h.Sequence,allowIn:!0,allowCall:!0})),c+1<k&&d.push(","+(m?A:u))});m&&!r(y(d).toString())&&d.push(A);d.push(m?v:"","}");break;case g.ThisExpression:d="this";break;case g.Identifier:d=a.name;break;case g.Literal:if(a.hasOwnProperty("raw")&&da)try{if(l=da(a.raw).body[0].expression,l.type===g.Literal&&l.value===a.value){d=a.raw;break}}catch(t){}if(null===a.value){d="null";break}if("string"===typeof a.value){d=
N(a.value);break}if("number"===typeof a.value){d=z(a.value);break}d=a.value.toString();break;default:throw Error("Unknown expression type: "+a.type);}return y(d,a)}function C(a,b){var d,f,e,c,k,l,m,p,t;k=!0;t="";m=l=!1;b&&(k=void 0===b.allowIn||b.allowIn,ja||!0!==b.semicolonOptional||(t=""),l=b.functionBody,m=b.directiveContext);switch(a.type){case g.BlockStatement:e=["{",A];D(function(){d=0;for(f=a.body.length;d<f;d+=1)p=[v,C(a.body[d],{semicolonOptional:d===f-1,directiveContext:l})],e.push(p),r(y(p).toString())||
e.push(A)});e.push([v,"}"]);break;case g.BreakStatement:e=a.label?"break "+a.label.name+t:"break"+t;break;case g.ContinueStatement:e=a.label?"continue "+a.label.name+t:"continue"+t;break;case g.DirectiveStatement:e=a.raw?a.raw+t:K(a.directive)+t;break;case g.DoWhileStatement:e=B("do",E(a.body));e=W(a.body,e);e=B(e,["while"+u+"(",q(a.test,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),")"+t]);break;case g.CatchClause:D(function(){e=["catch"+u+"(",q(a.param,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),
")"]});e.push(E(a.body));break;case g.DebuggerStatement:e="debugger"+t;break;case g.EmptyStatement:break;case g.ExpressionStatement:e=[q(a.expression,{precedence:h.Sequence,allowIn:!0,allowCall:!0})];"{"===e.toString().charAt(0)||"function"===e.toString().slice(0,8)&&0<=" (".indexOf(e.toString().charAt(8))||ka&&m&&a.expression.type===g.Literal&&"string"===typeof a.expression.value?e=["(",e,")"+t]:e.push(t);break;case g.VariableDeclarator:e=a.init?[a.id.name+u+"="+u,q(a.init,{precedence:h.Assignment,
allowIn:k,allowCall:!0})]:a.id.name;break;case g.VariableDeclaration:e=[a.kind];1===a.declarations.length&&a.declarations[0].init&&a.declarations[0].init.type===g.FunctionExpression?e.push(" ",C(a.declarations[0],{allowIn:k})):D(function(){c=a.declarations[0];L.comment&&c.leadingComments?e.push("\n",[v,C(c,{allowIn:k})]):e.push(" ",C(c,{allowIn:k}));d=1;for(f=a.declarations.length;d<f;d+=1)c=a.declarations[d],L.comment&&c.leadingComments?e.push(","+A,[v,C(c,{allowIn:k})]):e.push(","+u,C(c,{allowIn:k}))});
e.push(t);break;case g.ThrowStatement:e=[B("throw",q(a.argument,{precedence:h.Sequence,allowIn:!0,allowCall:!0})),t];break;case g.TryStatement:e=["try",E(a.block)];e=W(a.block,e);d=0;for(f=a.handlers.length;d<f;d+=1)if(e=B(e,C(a.handlers[d])),a.finalizer||d+1!==f)e=W(a.handlers[d].body,e);a.finalizer&&(e=B(e,["finally",E(a.finalizer)]));break;case g.SwitchStatement:D(function(){e=["switch"+u+"(",q(a.discriminant,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),")"+u+"{"+A]});if(a.cases)for(d=0,f=
a.cases.length;d<f;d+=1)p=[v,C(a.cases[d],{semicolonOptional:d===f-1})],e.push(p),r(y(p).toString())||e.push(A);e.push([v,"}"]);break;case g.SwitchCase:D(function(){e=a.test?[B("case",q(a.test,{precedence:h.Sequence,allowIn:!0,allowCall:!0})),":"]:["default:"];d=0;(f=a.consequent.length)&&a.consequent[0].type===g.BlockStatement&&(p=E(a.consequent[0]),e.push(p),d=1);for(d===f||r(y(e).toString())||e.push(A);d<f;d+=1)p=[v,C(a.consequent[d],{semicolonOptional:d===f-1&&""===t})],e.push(p),d+1===f||r(y(p).toString())||
e.push(A)});break;case g.IfStatement:D(function(){e=["if"+u+"(",q(a.test,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),")"]});a.alternate?(e.push(E(a.consequent)),e=W(a.consequent,e),e=a.alternate.type===g.IfStatement?B(e,["else ",C(a.alternate,{semicolonOptional:""===t})]):B(e,B("else",E(a.alternate,""===t)))):e.push(E(a.consequent,""===t));break;case g.ForStatement:D(function(){e=["for"+u+"("];a.init?a.init.type===g.VariableDeclaration?e.push(C(a.init,{allowIn:!1})):e.push(q(a.init,{precedence:h.Sequence,
allowIn:!1,allowCall:!0}),""):e.push("");a.test?e.push(u,q(a.test,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),""):e.push("");a.update?e.push(u,q(a.update,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),")"):e.push(")")});e.push(E(a.body,""===t));break;case g.ForInStatement:e=["for"+u+"("];D(function(){a.left.type===g.VariableDeclaration?D(function(){e.push(a.left.kind+" ",C(a.left.declarations[0],{allowIn:!1}))}):e.push(q(a.left,{precedence:h.Call,allowIn:!0,allowCall:!0}));e=B(e,"in");e=[B(e,
q(a.right,{precedence:h.Sequence,allowIn:!0,allowCall:!0})),")"]});e.push(E(a.body,""===t));break;case g.LabeledStatement:e=[a.label.name+":",E(a.body,""===t)];break;case g.Program:f=a.body.length;e=[O&&0<f?"\n":""];for(d=0;d<f;d+=1)p=[v,C(a.body[d],{semicolonOptional:!O&&d===f-1,directiveContext:!0})],e.push(p),d+1<f&&!r(y(p).toString())&&e.push(A);break;case g.FunctionDeclaration:e=["function "+a.id.name,ba(a)];break;case g.ReturnStatement:e=a.argument?[B("return",q(a.argument,{precedence:h.Sequence,
allowIn:!0,allowCall:!0})),t]:["return"+t];break;case g.WhileStatement:D(function(){e=["while"+u+"(",q(a.test,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),")"]});e.push(E(a.body,""===t));break;case g.WithStatement:D(function(){e=["with"+u+"(",q(a.object,{precedence:h.Sequence,allowIn:!0,allowCall:!0}),")"]});e.push(E(a.body,""===t));break;case g.Block:e=["/*"+a.value+"*/"];break;case g.Line:e=["//"+a.value];break;default:throw Error("Unknown statement type: "+a.type);}L.comment&&(e=P(a,e));p=
y(e).toString();a.type!==g.Program||O||""!==A||"\n"!==p.charAt(p.length-1)||(e=y(e).replaceRight(/\s+$/,""));return y(e,a)}function ea(a,b){var d,f,e,c,k,g,h,l={};d=[a];for(f=[null];d.length;)if(e=d.pop(),e===l){if(e=f.pop(),c=b.leave?b.leave(e,f[f.length-1]):void 0,c===J.Break)break}else if(e){c=b.enter?b.enter(e,f[f.length-1]):void 0;if(c===J.Break)break;d.push(l);f.push(e);if(c!==J.Skip)for(g=la[e.type],c=g.length;0<=--c;)if(h=e[g[c]])if(R(h))for(k=h.length;0<=--k;)h[k]&&d.push(h[k]);else d.push(h)}}
function X(a,b){var f,c,e,k;c=a.length;for(e=0;c;)f=c>>>1,k=e+f,b(a[k])?c=f:(e=k+1,c-=f+1);return e}function ma(a,b){var f;f=X(b,function(b){return b.range[0]>a.range[0]});a.extendedRange=[a.range[0],a.range[1]];f!==b.length&&(a.extendedRange[1]=b[f].range[0]);--f;0<=f&&(f<b.length?a.extendedRange[0]=b[f].range[1]:(void 0).length&&(a.extendedRange[1]=b[b.length-1].range[0]));return a}var g,h,ia,ha,la,J,U,R,v,I,F,Y,fa,S,ga,A,u,ca,ja,O,ka,L,da,M;g={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",
BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",
TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"};h={Sequence:0,Assignment:1,Conditional:2,LogicalOR:3,LogicalAND:4,BitwiseOR:5,BitwiseXOR:6,BitwiseAND:7,Equality:8,Relational:9,BitwiseSHIFT:10,Additive:11,Multiplicative:12,Unary:13,Postfix:14,Call:15,New:16,Member:17,Primary:18};ia={"||":h.LogicalOR,"&&":h.LogicalAND,
"|":h.BitwiseOR,"^":h.BitwiseXOR,"&":h.BitwiseAND,"==":h.Equality,"!=":h.Equality,"===":h.Equality,"!==":h.Equality,"<":h.Relational,">":h.Relational,"<=":h.Relational,">=":h.Relational,"in":h.Relational,"instanceof":h.Relational,"<<":h.BitwiseSHIFT,">>":h.BitwiseSHIFT,">>>":h.BitwiseSHIFT,"+":h.Additive,"-":h.Additive,"*":h.Multiplicative,"%":h.Multiplicative,"/":h.Multiplicative};ha={NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0\u08a2-\u08ac\u08e4-\u08fe\u0900-\u0963\u0966-\u096f\u0971-\u0977\u0979-\u097f\u0981-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d02\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191c\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1d00-\u1de6\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua697\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a\uaa7b\uaa80-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
(R=Array.isArray)||(R=function(a){return"[object Array]"===Object.prototype.toString.call(a)});m.prototype.toString=function(){var a="",b,f,c;b=0;for(f=this.children.length;b<f;++b)c=this.children[b],a=c instanceof m?a+c.toString():a+c;return a};m.prototype.replaceRight=function(a,b){var f=this.children[this.children.length-1];f instanceof m?f.replaceRight(a,b):"string"===typeof f?this.children[this.children.length-1]=f.replace(a,b):this.children.push("".replace(a,b));return this};m.prototype.join=
function(a){var b,f,c;c=[];f=this.children.length;if(0<f){b=0;for(--f;b<f;++b)c.push(this.children[b],a);c.push(this.children[f]);this.children=c}return this};la={AssignmentExpression:["left","right"],ArrayExpression:["elements"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DirectiveStatement:[],DoWhileStatement:["body",
"test"],DebuggerStatement:[],EmptyStatement:[],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],Identifier:[],IfStatement:["test","consequent","alternate"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],NewExpression:["callee","arguments"],ObjectExpression:["properties"],Program:["body"],
Property:["key","value"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handlers","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"]};J={Break:1,Skip:2};a.escodegen={};a.escodegen.version=
"0.0.13-dev";a.generate=function(a,c){var d={indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"ssss".replace(/s/g," "),base:0,adjustMultilineComment:!1},json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1},sourceMap:null,sourceMapWithCode:!1,directive:!1};null!=c?("string"===typeof c.indent&&(d.format.indent.style=c.indent),"number"===typeof c.base&&(d.format.indent.base=c.base),c=x(d,c),I=c.format.indent.style,
v="string"===typeof c.base?c.base:l(I,c.format.indent.base)):(c=d,I=c.format.indent.style,v=l(I,c.format.indent.base));F=c.format.json;Y=c.format.renumber;fa=F?!1:c.format.hexadecimal;S=F?"double":c.format.quotes;ga=c.format.escapeless;c.format.compact?A=u=I=v="":(A="\n",u=" ");ca=c.format.parentheses;ja=c.format.semicolons;O=c.format.safeConcatenation;ka=c.directive;da=F?null:c.parse;M=c.sourceMap;L=c;U=M?"undefined"!==typeof process?require("source-map").SourceNode:b.sourceMap.SourceNode:m;switch(a.type){case g.BlockStatement:case g.BreakStatement:case g.CatchClause:case g.ContinueStatement:case g.DirectiveStatement:case g.DoWhileStatement:case g.DebuggerStatement:case g.EmptyStatement:case g.ExpressionStatement:case g.ForStatement:case g.ForInStatement:case g.FunctionDeclaration:case g.IfStatement:case g.LabeledStatement:case g.Program:case g.ReturnStatement:case g.SwitchStatement:case g.SwitchCase:case g.ThrowStatement:case g.TryStatement:case g.VariableDeclaration:case g.VariableDeclarator:case g.WhileStatement:case g.WithStatement:d=
C(a);break;case g.AssignmentExpression:case g.ArrayExpression:case g.BinaryExpression:case g.CallExpression:case g.ConditionalExpression:case g.FunctionExpression:case g.Identifier:case g.Literal:case g.LogicalExpression:case g.MemberExpression:case g.NewExpression:case g.ObjectExpression:case g.Property:case g.SequenceExpression:case g.ThisExpression:case g.UnaryExpression:case g.UpdateExpression:d=q(a,{precedence:h.Sequence,allowIn:!0,allowCall:!0});break;default:throw Error("Unknown node type: "+
a.type);}if(!M)return d.toString();d=d.toStringWithSourceMap({file:c.sourceMap});return c.sourceMapWithCode?d:d.map.toString()};a.traverse=ea;a.attachComments=function(a,b,f){var c=[],e,k;if(!a.range)throw Error("attachComments needs range information");if(!f.length){if(b.length){k=0;for(e=b.length;k<e;k+=1)f=w(b[k]),f.extendedRange=[0,a.range[0]],c.push(f);a.leadingComments=c}return a}k=0;for(e=b.length;k<e;k+=1)c.push(ma(w(b[k]),f));ea(a,{cursor:0,enter:function(a){for(var b;this.cursor<c.length;){b=
c[this.cursor];if(b.extendedRange[1]>a.range[0])break;b.extendedRange[1]===a.range[0]?(a.leadingComments||(a.leadingComments=[]),a.leadingComments.push(b),c.splice(this.cursor,1)):this.cursor+=1}if(this.cursor===c.length)return J.Break;if(c[this.cursor].extendedRange[0]>a.range[1])return J.Skip}});ea(a,{cursor:0,leave:function(a){for(var b;this.cursor<c.length;){b=c[this.cursor];if(a.range[1]<b.extendedRange[0])break;a.range[1]===b.extendedRange[0]?(a.trailingComments||(a.trailingComments=[]),a.trailingComments.push(b),
c.splice(this.cursor,1)):this.cursor+=1}if(this.cursor===c.length)return J.Break;if(c[this.cursor].extendedRange[0]>a.range[1])return J.Skip}});return a};a.Syntax=g},this);void 0==String.prototype.format&&(String.prototype.format=function(a){if("object"==typeof a)return this.replace(/\{([\w\.]+)\}/g,function(b,c){return a[c]});a=Array.prototype.slice.apply(arguments);return ss=a.reduce(function(b,c,l){return b.replace("{i}".replace("i",l),a[l])},this.toString())});var w=function(a){this.name="Lexer";
this.line=1;this.source=a||"";this.p=0;this.column=1;this.indent=0;this.indent_size=4;this.c=this.source[this.p]};w.prototype.assert=function(a){throw Error("{0} {1}".format([(new m(this.line,this.column)).toString(),a]));};w.prototype.consume=function(){this.column=this.c.match(/^[\n|\r]$/)?1:this.column+1;this.p++;this.c=this.p<this.source.length?this.source[this.p]:b.EOF};w.prototype.lookahead=function(a){a=this.p+a;return a<this.source.length?this.source[a]:b.EOF};w.prototype.matchWhiteSpace=
function(a){return a.match(/^\s$/)&&!this.matchLineTerminator(a)};w.prototype.matchLineTerminator=function(a){return"\n"===a||"\r"===a||"\u2028"===a||"\u2029"===a};w.prototype.matchDigit=function(a){return"0"<=a&&"9">=a};w.prototype.matchLetter=function(a){return"A"<=a&&"Z">=a||"a"<=a&&"z">=a||"_"===a||"$"===a};w.prototype.tokenize=function(){this.line=1;var a=[];for((f=this.scanIndent())&&a.push(f);this.p<this.source.length;){var f;if(f=this.scanComment())a.push(f);else if(this.matchLineTerminator(this.c))(f=
this.scanLineTerminator())&&a.push(f),(f=this.scanIndent())&&a.push(f),this.line++;else if(this.matchWhiteSpace(this.c))this.consume();else if(";"==this.c)this.consume();else if(f=this.scanReservedWord())a.push(f);else if(this.matchLetter(this.c)&&(f=this.scanIdent()))a.push(f);else{if(this.matchDigit(this.c)&&(this.lookahead(1)!==b.EOF&&this.matchLetter(this.lookahead(1))&&this.assert(r.IllegalIdent),f=this.scanDigit())){a.push(f);continue}if("'"===this.c||'"'==this.c)if(f=this.scanString(this.c)){a.push(f);
continue}(f=this.scanPunctuator())?a.push(f):(f=this.scanRegularExpression())?a.push(f):(this.assert(r.UnknownToken),this.consume())}}a.push(new b(b.EOF,"",new m(this.line,this.column)));return a};w.prototype.scanIndent=function(){for(this.indent=0;this.p<this.source.length;){if(" "==this.c)this.indent++;else if("\t"==this.c)this.indent+=this.indent_size;else break;this.consume()}return new b(b.INDENT,this.indent,new m(this.line,this.column))};w.prototype.scanLineTerminator=function(){var a=this.c;
this.consume();"\r\n"==a+this.lookahead(1)&&(a+=this.lookahead(1),this.consume());return new b(b.NEWLINE,a,new m(this.line,this.column||this.indent+1))};w.prototype.scanComment=function(){var a=this.c;if("#"===a){this.consume();for(a="";this.c!==b.EOF&&!this.matchLineTerminator(this.c);)a+=this.c,this.consume();a=new b(b.COMMENT,a,new m(this.line,this.column));a.multiple=!1;return a}a=this.c+this.lookahead(1);if("/*"==a){this.consume();this.consume();for(a="";"*/"!=this.c+this.lookahead(1);)this.c===
b.EOF&&this.assert(r.IllegalComment),a+=this.c,this.consume();this.consume();this.consume();a=new b(b.COMMENT,a,new m(this.line,this.column));a.multiple=!0;return a}};w.prototype.scanReservedWord=function(){var a=this.scanKeyword();if(a||(a=this.scanFutureReservedWord()))return a;a=this.c+this.lookahead(1)+this.lookahead(2)+this.lookahead(3);if("None"===a)return this.consume(),this.consume(),this.consume(),this.consume(),new b(b.KEYWORDS.NONE,a,new m(this.line,this.column));a=this.c+this.lookahead(1)+
this.lookahead(2)+this.lookahead(3);if("true"===a)return this.consume(),this.consume(),this.consume(),this.consume(),new b(b.BOOLEAN,a,new m(this.line,this.column));a=this.c+this.lookahead(1)+this.lookahead(2)+this.lookahead(3)+this.lookahead(4);if("false"===a)return this.consume(),this.consume(),this.consume(),this.consume(),this.consume(),new b(b.BOOLEAN,a,new m(this.line,this.column))};w.prototype.scanKeyword=function(){for(var a="",f=this.p,c=this.source[this.p];this.c!==b.EOF;)if(this.matchLetter(c)||
this.matchDigit(c))a+=c,c=this.source[++f];else break;if(b.KEYWORDS[a.toUpperCase()]){f=b.KEYWORDS[a.toUpperCase()];for(c=0;c<f.length;)this.consume(),c++;return new b(f,a,new m(this.line,this.column))}};w.prototype.scanFutureReservedWord=function(){};w.prototype.scanIdent=function(){for(var a="";this.c!==b.EOF;)if(this.matchLetter(this.c)||this.matchDigit(this.c))a+=this.c,this.consume();else break;return new b(b.IDENTIFIER,a,new m(this.line,this.column))};w.prototype.scanPunctuator=function(){if(":"===
this.c){var a=this.c;this.consume();return new b(b.PUNCTUATOR,a,new m(this.line,this.column))}if("{"===this.c||"}"===this.c||"("===this.c||")"===this.c||"["===this.c||"]"===this.c||","===this.c||"."===this.c)return a=this.c,this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column));if((a=this.scanAssign())||(a=this.scanOperator()))return a};w.prototype.scanOperator=function(){var a=this.c+this.lookahead(1)+this.lookahead(2);if(">>>"===a||"<<<"===a)return this.consume(),this.consume(),this.consume(),
new b(b.PUNCTUATOR,a,new m(this.line,this.column));a=this.c+this.lookahead(1);if("++"===a||"--"===a||">>"===a||"<<"===a||"&&"===a||"||"===a)return this.consume(),this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column));a=this.c;if("+"===a||"-"===a||"*"===a||"/"===a||"%"===a||"<"===a||">"===a||"&"===a||"!"===a||"|"===a||"^"===a||"~"===a||"?"===a)return this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column))};w.prototype.scanAssign=function(){var a=this.c+this.lookahead(1)+this.lookahead(2)+
this.lookahead(3);if(">>>="===a)return this.consume(),this.consume(),this.consume(),this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column));a=this.c+this.lookahead(1)+this.lookahead(2);if("<<="===a||">>="===a||"!=="===a||"==="===a)return this.consume(),this.consume(),this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column));a=this.c+this.lookahead(1);if("*="===a||"/="===a||"%="===a||"+="===a||"-="===a||"&="===a||"^="===a||"|="===a||"<="===a||">="===a||"=="===a||"!="===a)return this.consume(),
this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column));a=this.c;if("="===a)return this.consume(),new b(b.PUNCTUATOR,a,new m(this.line,this.column))};w.prototype.scanDigit=function(){for(var a="";this.c!==b.EOF;)if(this.matchDigit(this.c)||"."===this.c)a+=this.c,this.consume();else break;a=a.match(/\./)?parseFloat(a,10):parseInt(a,10);return new b(b.DIGIT,a,new m(this.line,this.column))};w.prototype.scanString=function(a){var f="";new m(this.line,this.column);for(this.consume();;){(this.c===
b.EOF||this.matchLineTerminator(this.c))&&this.assert(r.UnexpectedString);if(this.c===a){this.consume();break}f+=this.c;this.consume()}f=new b(b.STRING,f,new m(this.line,this.column));f.delimiter=a;return f};w.prototype.scanRegularExpression=function(){};var m=function(a,b){this.name="Location";this.line=a;this.column=b};m.prototype.toString=function(){return"Line {0} Column {1}".format([this.line,this.column])};var r={UnknownToken:"Unknown token",UnexpectedToken:"Unexpected token",UnexpectedString:"Unexpected string",
IllegalReservedIdent:"Variables starting with __ are reserved",IllegalIdent:"Identifier can not start with numeric",IllegalIdentInitialize:"Identifier has to be initialized",IllegalComment:"Illegal comment",IllegalBlock:"Block statement must have one statement at least",IllegalFor:"Illegal for statement",IllegalWhile:"Illegal while statement",IllegalIf:"Illegal if statement",IllegalContinue:"Continue statement can not have label",IllegalContinuePosition:"Continue statement have to be declared in iteration",
IllegalBreak:"Break statement can not have label",IllegalBreakPosition:"Break statement have to be declared in iteration",IllegalReturn:"Return statement has to be contained in function",IllegalReturnArgument:"Return argument has to be one",IllegalRaise:"Illegal raise statement",IllegalRaiseArgument:"Raise argument has to be one",IllegalExcept:"Illegal except statement",IllegalFinally:"Illegal finally statement",IllegalConditionalExpression:"Illegal conditional expression",IllegalIndentSize:"Indent size may be incorrect",
IllegalArgument:"argument has to be identifier",IllegalArgumentList:"Arguments maybe includes newline",IllegalFunctionExpression:"Illegal function expression",IllegalPostfixIncrement:"Postfix increment operator is only for variable",IllegalPostfixDecrement:"Postfix decrement operator is only for variable",IllegalPrefixIncrement:"Prefix increment operator is only for variable",IllegalPrefixDecrement:"Prefix decrement operator is only for variable",IllegalMultiplicativeExpression:"Illegal multiplicative expression",
IllegalShiftExpression:"Illegal shift expression",IllegalRelationalExpression:"Illegal relational expression",IllegalIsinstance:"arguments of isinstance build-in function has to be two",IllegalTypeof:"argument of type build-in function has to be one",ReferenceError:"{0} is not defined"},c=function(a){this.name="Parser";this.p=0;this.token=a[0];this.tokens=a;this.indent=0;this.indent_size=4;this.ecstack=new K;this.state=new x};c.prototype.consume=function(a){for(a=a||1;0<a;)this.p++,this.token=this.p<
this.tokens.length?this.tokens[this.p]:new b(b.EOF,"",this.tokens[this.tokens.length-1].location),a--};c.prototype.match=function(a){return this.token.text===a};c.prototype.matchKind=function(a){return this.token.kind===a};c.prototype.expect=function(a){if(this.token.text===a)this.consume();else throw Error("{0} {1} {2} expecting {3}".format([this.token.location.toString(),r.UnexpectedToken,this.token.text,a]));};c.prototype.assert=function(a){throw Error("{0} {1}".format([this.token.location.toString(),
a]));};c.prototype.expectKind=function(a){if(this.token.kind===a)this.consume();else throw Error("{0} {1} {2} expecting {3}".format([this.token.location.toString(),r.UnexpectedToken,this.token.kind,a]));};c.prototype.lookahead=function(a){var f=this.tokens.length;a=this.p+a;return a<f?this.tokens[a]:new b(b.EOF,"",this.tokens[f-1].location)};c.prototype.lookback=function(a){a=this.p-a;return 0<=a?this.tokens[a]:this.tokens[0]};c.prototype.parseProgram=function(){this.p=0;this.expect(this.indent=0);
for(var a=1;a<this.tokens.length;a++)if(this.lookahead(a).kind===b.INDENT&&0<this.lookahead(a).text){this.indent_size=this.lookahead(a).text;break}return{type:Syntax.Program,body:this.parseSourceElements()}};c.prototype.parseSourceElements=function(){for(var a=[];!this.matchKind(b.EOF);){if(this.matchKind(b.INDENT)){if(-1!==this.state.current.indexOf(x.InFunction))break;this.expect(0)}if(this.match("class"))node=this.parseClassDeclaration(),a=a.concat(node);else if(node=this.parseSourceElement())node.type===
Syntax.PassStatement&&(node.type=Syntax.EmptyStatement),a.push(node)}return a};c.prototype.parseSourceElement=function(){if(!this.matchKind(b.EOF)){var a;a=this.match("def")?this.parseFunctionDeclaration():this.parseStatement();this.matchKind(b.NEWLINE)&&this.consume();return a}};c.prototype.parseStatement=function(){if(this.matchKind(b.IDENTIFIER)&&!this.ecstack.current[this.token.text]){if("="===this.lookahead(1).text)return this.parseVariableStatement();this.lookahead(1).kind!=b.NEWLINE&&this.lookahead(1).kind!=
b.EOF||this.assert(r.IllegalIdentInitialize)}if(this.matchKind(b.PUNCTUATOR)&&this.match(":"))return this.parseBlock();switch(this.token.kind){case b.COMMENT:return this.parseComment();case b.NEWLINE:return this.parseEmptyStatement();case b.KEYWORDS.PASS:return this.parsePassStatement();case b.KEYWORDS.IF:return this.parseIfStatement();case b.KEYWORDS.WHILE:return this.parseWhileStatement();case b.KEYWORDS.FOR:return this.parseForStatement();case b.KEYWORDS.CONTINUE:return this.parseContinueStatement();
case b.KEYWORDS.BREAK:return this.parseBreakStatement();case b.KEYWORDS.RETURN:return this.parseReturnStatement();case b.KEYWORDS.RAISE:return this.parseRaiseStatement();case b.KEYWORDS.TRY:return this.parseTryStatement();default:return this.parseExpressionStatement()}};c.prototype.parseBlock=function(){this.expect(":");var a=[];this.matchKind(b.NEWLINE)?(this.consume(),this.indent++,a=this.parseStatementList(),this.indent--):a=[this.parseStatement()];a.reduce(function(a,b,c){return a||b.type!==Syntax.EmptyStatement},
!1)||this.assert(r.IllegalBlock);return{type:Syntax.BlockStatement,body:a.map(function(a){a.type===Syntax.PassStatement&&(a.type=Syntax.EmptyStatement);return a})}};c.prototype.parseStatementList=function(){for(var a=[],f=this.indent*this.indent_size;!this.matchKind(b.EOF)&&!this.matchKind(b.NEWLINE);){if(this.matchKind(b.INDENT)){if(this.token.text<f)break;this.token.text>f&&this.assert(r.IllegalIndentSize);this.consume()}a.push(this.parseSourceElement())}return a};c.prototype.parseVariableStatement=
function(){return{type:Syntax.VariableDeclaration,declarations:this.parseVariableDeclarationList(),kind:"var"}};c.prototype.parseVariableDeclarationList=function(){for(var a=[];;){this.match(",")&&this.consume();if(this.token.kind===b.EOF||this.token.kind===b.NEWLINE)break;a.push(this.parseVariableDeclaration())}return a};c.prototype.parseVariableDeclaration=function(){var a=this.parseIdentifier(),b=this.parseInitialiser();this.ecstack.current[a.name]=b;return{type:Syntax.VariableDeclarator,id:a,
init:b}};c.prototype.parseInitialiser=function(){this.expect("=");return this.parseAssignmentExpression()};c.prototype.parseEmptyStatement=function(){this.expectKind(b.NEWLINE);if("INDENT"===this.lookback(2).kind)return{type:Syntax.EmptyStatement};this.consume();return this.parseStatement()};c.prototype.parsePassStatement=function(){this.expectKind(b.KEYWORDS.PASS);return{type:Syntax.PassStatement}};c.prototype.parseExpressionStatement=function(){if(!this.match("def")&&!this.match(":")&&(expr=this.parseExpression())){expr.type===
Syntax.AssignmentExpression&&expr.left.name&&(this.ecstack.current[expr.left.name]=expr.right);if(expr&&expr.left&&expr.left.object&&expr.left.object.type===Syntax.ThisExpression){var a=this.ecstack.pop();this.ecstack.current["this.{0}".format(expr.left.property.name)]=expr.right;this.ecstack.push(a||[])}return{type:Syntax.ExpressionStatement,expression:expr}}};c.prototype.parseIfStatement=function(){this.expect("if");var a=this.parseExpression(),f=null,c;this.match(":")||this.assert(r.IllegalIf);
c=this.parseStatement();this.matchKind(b.INDENT)&&(this.match(this.indent*this.indent_size)||this.assert(r.IllegalIndentSize));"else"===this.lookahead(1).text&&this.consume();this.match("else")&&(this.consume(),f=this.parseStatement());return{type:Syntax.IfStatement,test:a,consequent:c,alternate:f}};c.prototype.parseWhileStatement=function(){this.expect("while");var a=this.parseExpression(),b;try{this.state.current.push(x.InIteration),b=this.parseStatement(),this.state.pop()}catch(c){this.assert(r.IllegalWhile)}return{type:Syntax.WhileStatement,
test:a,body:b}};c.prototype.parseForStatement=function(){this.expect("for");for(var a=[],b,c,l;!this.match("in");)this.match(",")&&this.consume(),a.push(this.parseLeftHandSideExpression());b=a[0];this.expect("in");c=this.parseExpression();this.state.current.push(x.InIteration);l=this.parseStatement();this.state.pop();c&&l||this.assert(r.IllegalFor);1===a.length&&(c.type!==Syntax.AssignmentExpression&&(c={type:Syntax.AssignmentExpression,operator:"=",left:{type:"Identifier",name:"__arr"},right:c}),
b={type:b.type,name:"__k"},l.body=z.parse("{0} = {1}[{2}]".format(a[0].name,c.left.name,"__k")).body.concat(l.body));2===a.length&&(c.type!==Syntax.AssignmentExpression&&(c={type:Syntax.AssignmentExpression,operator:"=",left:{type:"Identifier",name:"__obj"},right:c}),l.body=z.parse("{0} = {1}[{2}]".format(a[1].name,c.left.name,a[0].name)).body.concat(l.body));return{type:Syntax.ForInStatement,left:b,right:c,body:l,each:!1}};c.prototype.parseContinueStatement=function(){this.expect("continue");this.token.kind!==
b.NEWLINE&&this.token.kind!==b.EOF&&this.assert(r.IllegalContinue);this.state.inIteration()||this.assert(r.IllegalContinuePosition);return{type:Syntax.ContinueStatement}};c.prototype.parseBreakStatement=function(){this.expect("break");this.token.kind!==b.NEWLINE&&this.token.kind!==b.EOF&&this.assert(r.IllegalBreak);this.state.inIteration()||this.assert(r.IllegalBreakPosition);return{type:Syntax.BreakStatement}};c.prototype.parseReturnStatement=function(){this.expect("return");var a=null;-1===this.state.current.indexOf(x.InFunction)&&
this.assert(r.IllegalReturn);this.token.kind!==b.NEWLINE&&this.token.kind!==b.EOF&&(a=this.parseExpression());this.token.kind!==b.NEWLINE&&this.token.kind!==b.EOF&&this.assert(r.IllegalReturnArgument);return{type:Syntax.ReturnStatement,argument:a}};c.prototype.parseRaiseStatement=function(){this.expect("raise");var a=null;this.token.kind!==b.NEWLINE&&this.token.kind!==b.EOF&&(a=this.parseExpression());null===a&&(a={type:"NewExpression",callee:{type:"Identifier",name:"Error"},arguments:[]});return{type:Syntax.ThrowStatement,
argument:a}};c.prototype.parseTryStatement=function(){this.expect("try");var a=[],b,c=null;this.ecstack.push([]);b=this.parseBlock();this.ecstack.pop();this.expect(this.indent*this.indent_size);a.push(this.parseExceptStatement());this.expect(this.indent*this.indent_size);this.match("finally")&&(this.consume(),this.ecstack.push([]),c=this.parseBlock(),this.ecstack.pop());return{type:Syntax.TryStatement,block:b,handlers:a,finalizer:c}};c.prototype.parseExceptStatement=function(){this.expect("except");
var a,b;this.match(":")&&(a={type:Syntax.Identifier,name:"e"});a=a||this.parseIdentifier();this.ecstack.push([]);b=this.parseBlock();this.ecstack.pop();return{type:Syntax.CatchClause,param:a,guard:null,body:b}};c.prototype.parsePrimaryExpression=function(){if(this.token.kind===b.KEYWORDS.THIS)return this.consume(),{type:Syntax.ThisExpression};if(this.token.kind===b.IDENTIFIER)return this.parseIdentifier();if(this.token.kind===b.KEYWORDS.NONE||this.token.kind===b.BOOLEAN||this.token.kind===b.DIGIT||
this.token.kind===b.STRING)return this.parseLiteral();if(this.token.kind===b.PUNCTUATOR){if(this.match("["))return this.parseArrayInitialiser();if(this.match("{"))return this.parseObjectInitialiser();if(this.match("("))return this.parseGroupingOperator()}this.assert(r.UnexpectedToken+" "+this.token.text)};c.prototype.parseIdentifier=function(){var a=this.token;this.consume();return{type:Syntax.Identifier,name:a.text}};c.prototype.parseLiteral=function(){if(this.token.kind===b.KEYWORDS.NONE){var a;
this.consume();return{type:Syntax.Literal,value:null}}if(this.token.kind===b.BOOLEAN)return a=this.token,this.consume(),{type:Syntax.Literal,value:"true"===a.text};if(this.token.kind===b.DIGIT)return a=this.token,this.consume(),{type:Syntax.Literal,value:a.text};if(this.token.kind===b.STRING){if('"'===this.token.delimiter)return this.parseStringVariable();a=this.token;this.consume();return{type:Syntax.Literal,value:a.text,raw:"'{0}'".format(a.text)}}};c.prototype.parseStringVariable=function(){var a=
this.token;this.consume();if(arguments=a.text.match(/\{([\w\.]+)\}/g)){var b=0,a=a.text.replace(/\{([\w\.]+)\}/g,function(a,c,m){return"{{0}}".format(b++)});return{type:Syntax.CallExpression,callee:{type:Syntax.MemberExpression,computed:!1,object:{type:Syntax.Literal,value:a,raw:'"{0}"'.format(a)},property:{type:Syntax.Identifier,name:"format"}},arguments:arguments.map(function(a){return{type:Syntax.Identifier,name:a.match(/\{([\w\.]+)\}/)[1]}})}}return{type:Syntax.Literal,value:a.text,raw:'"{0}"'.format(a.text)}};
c.prototype.parseArrayInitialiser=function(){this.expect("[");var a=this.parseElementList();this.expect("]");return{type:Syntax.ArrayExpression,elements:a}};c.prototype.parseElementList=function(){for(var a=[];!this.match("]");)this.match(",")&&this.consume(),this.token.kind===b.NEWLINE||this.token.kind===b.INDENT?this.consume():a.push(this.parseAssignmentExpression());return a};c.prototype.parseElision=function(){};c.prototype.parseObjectInitialiser=function(){this.expect("{");var a=this.parsePropertyNameAndValueList();
this.expect("}");return{type:Syntax.ObjectExpression,properties:a}};c.prototype.parsePropertyNameAndValueList=function(){for(var a=[];!this.match("}");)if(this.match(",")||this.matchKind(b.INDENT)||this.matchKind(b.NEWLINE)||this.matchKind(b.EOF))this.consume();else{var f=this.parsePropertyName();this.expect(":");var c=this.parseAssignmentExpression();a.push({type:Syntax.Property,key:f,value:c,raw:"init"})}return a};c.prototype.parsePropertyName=function(){var a=this.token;if(this.token.kind===b.IDENTIFIER)return this.consume(),
{type:Syntax.Identifier,value:a.text};if(this.token.kind===b.STRING||this.token.kind===b.DIGIT)return this.consume(),{type:Syntax.Literal,value:a.text}};c.prototype.parseGroupingOperator=function(){this.expect("(");var a=this.parseExpression();this.expect(")");return a};c.prototype.parseMemberExpression=function(a){if(this.match("new"))return this.parseNewExpression();for(var b=this.parseFunctionExpression()||this.parsePrimaryExpression();;)if(this.match("["))b=this.parseComputedMember(b);else if(this.match("."))b=
this.parseNonComputedMember(b);else if(this.match("(")&&a)b=this.parseCallMember(b);else break;return b};c.prototype.parseComputedMember=function(a){var b;this.expect("[");b=this.parseExpression();this.expect("]");return{type:Syntax.MemberExpression,computed:!0,object:a,property:b}};c.prototype.parseNonComputedMember=function(a){this.expect(".");return{type:Syntax.MemberExpression,computed:!1,object:a,property:this.parseIdentifier()}};c.prototype.parseCallMember=function(a){return{type:Syntax.CallExpression,
callee:a,arguments:this.parseArguments()}};c.prototype.parseNewExpression=function(){return this.match("new")?(this.consume(),{type:Syntax.NewExpression,callee:this.parseNewExpression(),arguments:this.parseArguments()}):this.parseMemberExpression()};c.prototype.parseArguments=function(){this.expect("(");arguments=this.parseArgumentList();this.expect(")");return arguments};c.prototype.parseArgumentList=function(){for(arguments=[];!this.match(")");){arguments.push(this.parseAssignmentExpression());
if(this.match(")"))break;this.match(",")?this.consume():this.assert(r.IllegalArgumentList)}return arguments};c.prototype.parseFunctionExpression=function(){if(this.match("(")){for(var a=1;")"!==this.lookahead(a).text&&this.lookahead(a).kind!==b.NEWLINE&&this.lookahead(a).kind!==b.EOF;)a++;if(":"===this.lookahead(++a).text)return arguments=this.parseFormalParameterList(),this.expect(":"),this.ecstack.push([]),this.state.push([x.InFunction]),a=this.parseExpressionStatement(),a=arguments.init.concat(a),
a.push({type:Syntax.ReturnStatement,argument:a.pop().expression}),this.state.pop(),this.ecstack.pop(),{type:Syntax.FunctionExpression,id:null,params:arguments.params,defaults:[],body:{type:Syntax.BlockStatement,body:a},rest:null,generator:!1,expression:!1}}};c.prototype.parseLeftHandSideExpression=function(){return this.match("new")?this.parseNewExpression():this.parseMemberExpression(!0)};c.prototype.parsePostfixExpression=function(){var a=this.parseLeftHandSideExpression(),b=this.token;return this.match("++")||
this.match("--")?(this.consume(),{type:Syntax.UpdateExpression,operator:b.text,argument:a,prefix:!1}):a};c.prototype.parseUnaryExpression=function(){var a=this.token;if(this.matchKind(b.PUNCTUATOR)){if(this.match("++")||this.match("--"))return this.consume(),{type:Syntax.UpdateExpression,operator:a.text,argument:this.parseUnaryExpression(),prefix:!0};if(this.match("+")||this.match("-")||this.match("~")||this.match("!"))return this.consume(),{type:Syntax.UnaryExpression,operator:a.text,argument:this.parseUnaryExpression()}}if(this.matchKind("delete")||
this.matchKind("typeof")||this.matchKind("not")){if(this.match("delete"))return this.consume(),{type:Syntax.UnaryExpression,operator:a.text,argument:this.parseUnaryExpression()};if(this.match("typeof"))return this.consume(),{type:Syntax.UnaryExpression,operator:"typeof",argument:this.parseUnaryExpression()};if(this.match("not"))return this.consume(),{type:Syntax.UnaryExpression,operator:"!",argument:this.parseUnaryExpression()}}return this.parsePostfixExpression()};c.prototype.parseMultiplicativeExpression=
function(){for(var a=this.parseUnaryExpression(),b=this.token;this.match("/")||this.match("*")||this.match("%");)this.consume(),a={type:Syntax.BinaryExpression,operator:b.text,left:a,right:this.parseUnaryExpression()};return a};c.prototype.parseAdditiveExpression=function(){for(var a=this.parseMultiplicativeExpression(),b=this.token;this.match("+")||this.match("-");)this.consume(),a={type:Syntax.BinaryExpression,operator:b.text,left:a,right:this.parseMultiplicativeExpression()};return a};c.prototype.parseShiftExpression=
function(){for(var a=this.parseAdditiveExpression(),b=this.token;this.match("<<")||this.match(">>")||this.match(">>>");)this.consume(),a={type:Syntax.BinaryExpression,operator:b.text,left:a,right:this.parseAdditiveExpression()};return a};c.prototype.parseRelationalExpression=function(){for(var a="< > <= >= instanceof in".split(" "),b=this.parseShiftExpression();-1<a.indexOf(this.token.text);){var c=this.token;this.consume();var l=this.parseAssignmentExpression();if("in"===c.text){if("!"===b.operator&&
l.type===Syntax.ObjectExpression){b.argument={type:Syntax.BinaryExpression,operator:c.text,left:b.argument,right:l};continue}if(l.type===Syntax.ArrayExpression||l.type===Syntax.Identifier){l.type===Syntax.Identifier&&(c=this.ecstack.find(l.name),c.type!==Syntax.ArrayExpression&&this.assert(r.IllegalRelationalExpression),c||this.assert(r.ReferenceError.format(l.name)));var c=b,m="!==";"!"===c.operator&&(c=b.argument,m="===");b={type:Syntax.BinaryExpression,operator:m,left:{type:Syntax.CallExpression,
callee:{type:Syntax.MemberExpression,computed:!1,object:l,property:{type:Syntax.Identifier,name:"indexOf"}},arguments:[c]},right:{type:Syntax.UnaryExpression,operator:"-",argument:{type:Syntax.Literal,value:1,raw:"1"}}};continue}}b={type:Syntax.BinaryExpression,operator:c.text,left:b,right:l}}return b};c.prototype.parseEqualityExpression=function(){for(var a=this.parseRelationalExpression();this.match("==")||this.match("!=")||this.match("is");){var b=this.token.text;this.consume();"is"===b&&(b="==",
this.match("not")&&(this.consume(),b="!="));a={type:Syntax.BinaryExpression,operator:b,left:a,right:this.parseShiftExpression()}}for(;this.match("===")||this.match("!==");)b=this.token,this.consume(),a={type:Syntax.BinaryExpression,operator:b.text,left:a,right:this.parseShiftExpression()};return a};c.prototype.parseBitwiseANDExpression=function(){for(var a=this.parseEqualityExpression(),b=this.token;this.match("&");)this.consume(),a={type:Syntax.BinaryExpression,operator:b.text,left:a,right:this.parseEqualityExpression()};
return a};c.prototype.parseBitwiseXORExpression=function(){for(var a=this.parseBitwiseANDExpression();this.match("^");)this.consume(),a={type:Syntax.BinaryExpression,operator:"^",left:a,right:this.parseBitwiseANDExpression()};return a};c.prototype.parseBitwiseORExpression=function(){for(var a=this.parseBitwiseXORExpression(),b=this.token;this.match("|");)this.consume(),a={type:Syntax.BinaryExpression,operator:b.text,left:a,right:this.parseBitwiseXORExpression()};return a};c.prototype.parseLogicalANDExpression=
function(){for(var a=this.parseBitwiseORExpression();this.match("and");)this.consume(),a={type:Syntax.BinaryExpression,operator:"&&",left:a,right:this.parseBitwiseORExpression()};return a};c.prototype.parseLogicalORExpression=function(){for(var a=this.parseLogicalANDExpression();this.match("or");)this.consume(),a={type:Syntax.BinaryExpression,operator:"||",left:a,right:this.parseBitwiseORExpression()};return a};c.prototype.parseConditionalExpression=function(){var a=this.parseLogicalORExpression(),
b;return this.match("if")?(this.consume(),b=this.parseLogicalORExpression(),this.expect("else"),{type:Syntax.ConditionalExpression,test:b,consequent:a,alternate:this.parseLogicalORExpression()}):a};c.prototype.parseAssignmentExpression=function(){var a=this.parseConditionalExpression(),b=this.token;this.matchAssign(b.text)&&(this.consume(),a={type:Syntax.AssignmentExpression,operator:b.text,left:a,right:this.parseAssignmentExpression()});return a};c.prototype.matchAssign=function(a){return">>>="===
a||"<<="===a||">>="===a||"!=="===a||"==="===a||"*="===a||"/="===a||"%="===a||"+="===a||"-="===a||"&="===a||"^="===a||"|="===a||"<="===a||">="===a||"=="===a||"!="===a||"="===a?!0:!1};c.prototype.parseExpression=function(){var a=this.parseAssignmentExpression();if(this.match(","))for(a={type:Syntax.SequenceExpression,expressions:[a]};this.match(",");)this.consume(),a.expressions.push(this.parseAssignmentExpression());return a};c.prototype.parseComment=function(){var a=this.token;this.consume();return a.multiple?
{type:Syntax.Block,value:a.text}:{type:Syntax.Line,value:a.text}};c.prototype.parseFunctionDeclaration=function(){this.expect("def");var a,b,c;a=this.parseIdentifier();b=this.parseFormalParameterList();c=this.parseFunctionBody();c=c.shift();c.body=b.init.concat(c.body);return{type:Syntax.FunctionDeclaration,id:a,params:b.params,body:c}};c.prototype.parseFormalParameterList=function(){var a=[],b=[];for(this.expect("(");!this.match(")");){this.match(",")&&this.consume();var c=this.parsePrimaryExpression();
c.type!==Syntax.Identifier&&this.assert(r.IllegalArgument);this.match("=")&&(this.consume(),b.push(this.parseDefaultArgument(c,this.parsePrimaryExpression())));a.push(c)}this.expect(")");return{params:a,init:b}};c.prototype.parseDefaultArgument=function(a,b){return{type:Syntax.ExpressionStatement,expression:{type:Syntax.AssignmentExpression,operator:"=",left:a,right:{type:Syntax.LogicalExpression,operator:"||",left:a,right:b}}}};c.prototype.parseFunctionBody=function(){var a;this.ecstack.push([]);
this.state.push([x.InFunction]);a=this.parseSourceElements();this.state.pop();this.ecstack.pop();return a};c.prototype.parseClassDeclaration=function(){this.expect("class");var a=this.parseIdentifier(),b;this.ecstack.push([]);this.state.push([x.InClass]);this.match("(")&&(this.consume(),b=this.parseInheritDeclaration(a),this.expect(")"));a=this.parseClassBody(a);if(b){var c=a.shift();a.unshift(b);a.unshift(c)}this.state.pop();this.ecstack.pop();return a};c.prototype.parseClassBody=function(a){this.expect(":");
this.indent++;for(var c=[],k=[],l=this.parseClassConstructorDeclaration(a,!0);!this.matchKind(b.EOF);)if(this.matchKind(b.NEWLINE))this.consume();else if(this.matchKind(b.INDENT)){if(this.lookahead(1).kind!==b.NEWLINE&&this.token.text<this.indent*this.indent_size)break;this.consume()}else if("="===this.lookahead(1).text){var m="this.{0}".format(z.codegen(this.parseAssignmentExpression()));k.push(z.parse(m).body[0])}else if("("===this.lookahead(1).text)this.match("constructor")?l=this.parseClassConstructorDeclaration(a):
c.push(this.parseClassFunctionDeclaration(a));else break;l.declarations[0].init.body.body=k.concat(l.declarations[0].init.body.body);c.unshift(l);c.push({type:Syntax.EmptyStatement});this.indent--;return c};c.prototype.parseClassConstructorDeclaration=function(a,b){var c=[],l={type:Syntax.BlockStatement,body:[]};b||(this.parseIdentifier(),c=this.parseFormalParameterList(),l=this.parseFunctionBody().shift(),l.body=c.init.concat(l.body),c=c.params);return{type:Syntax.VariableDeclaration,declarations:[{type:Syntax.VariableDeclarator,
id:a,init:{type:Syntax.FunctionExpression,id:null,params:c,defaults:[],body:l,rest:null,generator:!1,expression:!1}}],kind:"var"}};c.prototype.parseInheritDeclaration=function(a){var b=this.parseIdentifier();return{type:Syntax.ExpressionStatement,expression:{type:Syntax.AssignmentExpression,operator:"=",left:{type:Syntax.MemberExpression,computed:!1,object:a,property:{type:Syntax.Identifier,name:"prototype"}},right:{type:Syntax.CallExpression,callee:{type:Syntax.MemberExpression,computed:!1,object:{type:Syntax.Identifier,
name:"Object"},property:{type:Syntax.Identifier,name:"create"}},arguments:[{type:Syntax.MemberExpression,computed:!1,object:b,property:{type:Syntax.Identifier,name:"prototype"}}]}}}};c.prototype.parseClassFunctionDeclaration=function(a){var b=this.parseIdentifier(),c=this.parseFormalParameterList(),l=this.parseFunctionBody().shift();l.body=c.init.concat(l.body);return{type:Syntax.ExpressionStatement,expression:{type:Syntax.AssignmentExpression,operator:"=",left:{type:Syntax.MemberExpression,computed:!1,
object:{type:Syntax.MemberExpression,computed:!1,object:a,property:{type:Syntax.Identifier,name:"prototype"}},property:b},right:{type:Syntax.FunctionExpression,id:null,params:c.params,defaults:[],body:l,rest:null,generator:!1,expression:!1}}}};c.prototype.parse=c.prototype.parseProgram;var x=function(){Array.call(this,arguments);this.current=null;this.push([])};x.prototype=Object.create(Array.prototype);x.prototype.push=function(){Array.prototype.push.call(this,arguments);this.current=this[this.length-
1][0]};x.prototype.pop=function(){1<this.length&&(Array.prototype.pop.call(this),this.current=this[this.length-1][0])};x.prototype.inClass=function(){return-1<this.current.indexOf(x.InIteration)};x.prototype.inFunction=function(){return-1<this.current.indexOf(x.InFunction)};x.prototype.inIteration=function(){return-1<this.current.indexOf(x.InIteration)};x.InClass=0;x.InFunction=1;x.InIteration=2;Syntax=N.Syntax;Syntax.PassStatement="PassStatement";Syntax.Block="Block";Syntax.Line="Line";var b=function(a,
b,c){this.name="Token";this.kind=a;this.text=b;this.location=c};b.prototype.toString=function(){return"{0} kind:{1} text:{2}".format([this.location.toString(),this.kind,this.text])};b.EOF="<END>";b.NEWLINE="NEWLINE";b.INDENT="INDENT";b.IDENTIFIER="IDENTIFIER";b.DIGIT="DIGIT";b.PUNCTUATOR="PUNCTUATOR";b.STRING="STRING";b.OPERATOR="OPERATOR";b.ASSIGN="ASSIGN";b.COLON="COLON";b.COMMENT="COMMENT";b.BOOLEAN="BOOLEAN";b.KEYWORDS=[];b.KEYWORDS.AND="and";b.KEYWORDS.BREAK="break";b.KEYWORDS.CATCH="catch";
b.KEYWORDS.CLASS="class";b.KEYWORDS.CONTINUE="continue";b.KEYWORDS.DELETE="delete";b.KEYWORDS.ELSE="else";b.KEYWORDS.DEF="def";b.KEYWORDS.FINALLY="finally";b.KEYWORDS.FOR="for";b.KEYWORDS.IF="if";b.KEYWORDS.IN="in";b.KEYWORDS.IS="is";b.KEYWORDS.NEW="new";b.KEYWORDS.NOT="not";b.KEYWORDS.OR="or";b.KEYWORDS.PASS="pass";b.KEYWORDS.RETURN="return";b.KEYWORDS.THIS="this";b.KEYWORDS.TRY="try";b.KEYWORDS.RAISE="raise";b.KEYWORDS.VOID="void";b.KEYWORDS.WHILE="while";b.KEYWORDS.XOR="xor";b.KEYWORDS.NONE="none";
b.KEYWORDS.VAR="var";b.KEYWORDS.TYPEOF="typeof";z.tokenize=function(a){return(new w(a)).tokenize()};z.parse=function(a){return(new c(z.tokenize(a))).parse()};z.codegen=function(a){return N.generate(a)};z.compile=function(a){return z.codegen(z.parse(a))};z.run=function(){throw Error("has to call after compile. confirm whether compile() have been called");};z.interpret=function(a){return(new Function(z.compile(a)))()};return z}();
