<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>toyscript</title>
<link rel="stylesheet" type="text/css" href="styles/style.css" />
<link href='http://fonts.googleapis.com/css?family=Ribeye+Marrow' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Emilys+Candy' rel='stylesheet' type='text/css'>
</head>
<body>
    
    <section class="container">
        
        <header>
            <h1>toyscript</h1>
            <p>A small experimental programing language works on your browser.</p>
        </header>
        
        
        <section>
            
            <h2>Try it</h2>
            
            <div id="editor.tryit.toy" class="editor"></div>
            <div id="editor.tryit.js" class="editor"></div>
            <span>
                <a class="btn run" href="#">Run</a>
            </span>
            
        </section>
        
    </section>

<script type="text/toy" data-source="editor.tryit.toy">class Toy:
    constructor():
        this.name = 'Toy'
    hello():
        return "Hello there, I am {this.name}!"

alert((new Toy()).hello())
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="scripts/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="scripts/toyscript.js" type="text/javascript"></script>
<script type="text/javascript">

$(function() {
    
    var try_it_code = $('script[data-source="editor.tryit.toy"]').text();
    var editor1 = ace.edit("editor.tryit.toy");
    var editor2 = ace.edit("editor.tryit.js");
    
    
    editor1.getSession().setMode("ace/mode/python");
    editor1.setValue(try_it_code);
    editor1.gotoLine(1);
    editor1.getSession().on('change', function(e) {
        var code = editor1.getValue();
        editor2.setValue(toy.compile(code));
        editor2.gotoLine(1);
    });
    
    
    editor2.getSession().setMode("ace/mode/javascript");
    editor2.setReadOnly(true);
    editor2.setValue(toy.compile(try_it_code));
    editor2.gotoLine(1);
    
    $('.run').on('click', function() {
        
        var compiled = toy.compile(editor1.getValue())
        new Function(compiled)();
        return false;
    });
});

</script>
</body>
</html>